# Система логирования для турникета

## Новые классы

### TimeManager (TimeManager.h/.cpp)
Управление временем системы:
- При запуске запрашивает текущую дату и время по Serial порту
- Формат ввода: `DD:MM:YYYY HH:MM:SS` (например, `25:12:2024 14:30:00`)
- Использует внутренний секундомер Arduino (millis()) для отсчета времени
- Предоставляет текущую дату и время в любой момент

### Logger (Logger.h/.cpp)
Система логирования событий:
- Логирует только завершенные действия в файл `logs.txt` на SD карте
- Формат лога: `<Дата и время> <id карты> : <Разрешение прохода> [Прошёл ли]`
- Два типа логов:
  - **Проход разрешен** - человек зарегистрирован и прошел
  - **Проход разрешен НЕ ПРОШЕЛ** - человек зарегистрирован, но не прошел
  - **Проход запрещен** - ID не найден в базе

### CommandHandler (CommandHandler.h/.cpp)
Обработчик Serial команд для управления системой:
- `get logs` - получить все логи из файла logs.txt
- `get ids` - получить все ID из файла ids.data
- `put <id карты>` - добавить ID (формат: "AA BB CC DD")
- `remove <id карты>` - удалить ID из базы
- `clear logs` - очистить файл logs.txt
- `clear ids` - очистить файл ids.data
- `serial enable` - включить отправку логов в Serial
- `serial disable` - выключить отправку логов в Serial (по умолчанию)

## Обновленные классы

### Turnstile
Добавлено логирование в состояниях:
- При доступе запрещен - логирует "Проход запрещен"
- При проходе не осуществлен - логирует "Проход разрешен НЕ ПРОШЕЛ"
- При успешном проходе - логирует "Проход разрешен"

### IDStorage
Добавлены методы для управления ID:
- `addID()` - добавить ID в файл
- `removeID()` - удалить ID из файла
- `getAllIDs()` - получить все ID в формате строки
- `clearAll()` - очистить файл ids.data

## Использование

### Запуск системы
При включении Arduino система запросит дату и время:
```
Please enter current date and time (format: DD:MM:YYYY HH:MM:SS)
Example: 25:12:2024 14:30:00
> 25:12:2024 14:30:00
Time set: 25:12:2024 14:30:00
```

### Управление через Serial

**Добавление ID карты:**
```
> put 12 34 56 78
OK
```

**Получение всех ID:**
```
> get ids
12 34 56 78
AA BB CC DD
EE FF 00 11
```

**Удаление ID:**
```
> remove 12 34 56 78
OK
```

**Получение логов:**
```
> get logs
25:12:2024 14:30:05 12 34 56 78 : Проход разрешен
25:12:2024 14:32:10 AA BB CC DD : Проход запрещен
25:12:2024 14:35:22 EE FF 00 11 : Проход разрешен НЕ ПРОШЕЛ
```

**Очистка логов:**
```
> clear logs
OK
```

**Включение Serial логирования:**
```
> serial enable
OK
```

## Формат логов

Формат записи в logs.txt:
```
ДД:ММ:ГГГГ ЧЧ:ММ:СС <ID> : <Статус> [Дополнительно]
```

Примеры:
```
25:12:2024 14:30:05 12 34 56 78 : Проход разрешен
25:12:2024 14:32:10 AA BB CC DD : Проход запрещен
25:12:2024 14:35:22 EE FF 00 11 : Проход разрешен НЕ ПРОШЕЛ
```

Где:
- Дата и время в формате `dd:MM:yyyy hh:mm:ss`
- ID карты в шестнадцатеричном формате (двузначные числа разделенные пробелом)
- Статус прохода
- "НЕ ПРОШЕЛ" добавляется только если проход был разрешен, но человек не прошел

